<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>sgdk: mapper.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">sgdk</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('mapper_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mapper.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Mapper / bank switch methods.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="types_8h_source.html">types.h</a>&quot;</code><br/>
</div>
<p><a href="mapper_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a325de47aab9559936677898563c164d8"></a><!-- doxytag: member="mapper.h::MAPPER_BASE" ref="a325de47aab9559936677898563c164d8" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAPPER_BASE</b>&#160;&#160;&#160;0xA130F1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acb7dc5a33a5b4a8d2b71e744832f9523"></a><!-- doxytag: member="mapper.h::BANK_SIZE" ref="acb7dc5a33a5b4a8d2b71e744832f9523" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BANK_SIZE</b>&#160;&#160;&#160;0x80000</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac60597badc76e6f2c5ce64d862746c67"></a><!-- doxytag: member="mapper.h::BANK_MASK" ref="ac60597badc76e6f2c5ce64d862746c67" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BANK_MASK</b>&#160;&#160;&#160;(BANK_SIZE - 1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#ae249f87ab1a28f3ed37cbd811c14c51a">FAR</a>(data)&#160;&#160;&#160;data</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Give access to specified 'far' data through SEGA official bank switch mechanism if needed.  <a href="#ae249f87ab1a28f3ed37cbd811c14c51a"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a8aa9149a22317014c683c48cebd8cfef">u16</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#ab4822912ad9431772cfecd6cee658784">SYS_getBank</a> (<a class="el" href="types_8h.html#a8aa9149a22317014c683c48cebd8cfef">u16</a> regionIndex)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current bank of specified region index.  <a href="#ab4822912ad9431772cfecd6cee658784"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#a48c54175e83a58e50f896518addb0773">SYS_setBank</a> (<a class="el" href="types_8h.html#a8aa9149a22317014c683c48cebd8cfef">u16</a> regionIndex, <a class="el" href="types_8h.html#a8aa9149a22317014c683c48cebd8cfef">u16</a> bankIndex)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the current bank of specified region index.  <a href="#a48c54175e83a58e50f896518addb0773"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapper_8h.html#ad2ef2c089ec2efc0d581e6705268359e">SYS_getFarData</a> (void *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the given binary data ressource accessible and return a pointer to it.  <a href="#ad2ef2c089ec2efc0d581e6705268359e"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Mapper / bank switch methods. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Stephane Dallongeville </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>01/2020</dd></dl>
<p>This unit provides tools to deal with ROM larger than 4MB.<br/>
 It allows to do classic bank switching using the official SEGA mapper but also provide methods to get easy access to "far" data.<br/>
 Note that you can use the ENABLE_BANK_SWITCH flag in <a class="el" href="config_8h.html" title="Basic SGDK library configuration file.">config.h</a> file to enable automatic bank switch on binary data access.<br/>
 <br/>
 SEGA official mapper description (taken from Segaretro.org):<br/>
 The bankswitching mechanism is very simple. It views the addressable 4 mega-bytes of ROM as 8 512KB regions.<br/>
 The first area, 0x000000-0x07FFFF is fixed and cannot be remapped because that is where the vector table resides.<br/>
 The banking registers on the cartridge work by allocating the 512KB chunk to a given part of the addressable 4MB ROM space.<br/>
 Below are the registers and what range they correspond to. The value written to a register will cause the specified 512KB page to be mapped to that region.<br/>
 A page is specified with 6 bits (bits 7 and 6 are always 0) thus allowing a possible 64 pages = 32 MB (SSFII only has 10, though.)<br/>
 <br/>
 0xA130F3: 0x080000 - 0x0FFFFF<br/>
 0xA130F5: 0x100000 - 0x17FFFF<br/>
 0xA130F7: 0x180000 - 0x1FFFFF<br/>
 0xA130F9: 0x200000 - 0x27FFFF<br/>
 0xA130FB: 0x280000 - 0x2FFFFF<br/>
 0xA130FD: 0x300000 - 0x37FFFF<br/>
 0xA130FF: 0x380000 - 0x3FFFFF<br/>
 <br/>
 The registers are accessed through byte writes.<br/>
 Examples:<br/>
 If 0x01 is written to register 0xA130FF, 0x080000-0x0FFFFF is visible at 0x380000-0x3FFFFF.<br/>
 If 0x08 is written to register 0xA130F9, the first 512KB of the normally invisible upper 1MB of ROM is now visible at 0x200000-0x27FFFF.<br/>
 <br/>
 The registers simply represent address ranges in the 4MB ROM area and you can page in data to these ranges by specifying the bank # </p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="ae249f87ab1a28f3ed37cbd811c14c51a"></a><!-- doxytag: member="mapper.h::FAR" ref="ae249f87ab1a28f3ed37cbd811c14c51a" args="(data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data</td><td>)</td>
          <td>&#160;&#160;&#160;data</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Give access to specified 'far' data through SEGA official bank switch mechanism if needed. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="config_8h.html#a8e5f37f8dd287ef08c10552d637738a7" title="Set it to 1 to enable automatic bank switch using official SEGA mapper for ROM &gt; 4MB.">ENABLE_BANK_SWITCH</a> flag in <a class="el" href="config_8h.html" title="Basic SGDK library configuration file.">config.h</a> file </dd></dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ab4822912ad9431772cfecd6cee658784"></a><!-- doxytag: member="mapper.h::SYS_getBank" ref="ab4822912ad9431772cfecd6cee658784" args="(u16 regionIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a8aa9149a22317014c683c48cebd8cfef">u16</a> SYS_getBank </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a8aa9149a22317014c683c48cebd8cfef">u16</a>&#160;</td>
          <td class="paramname"><em>regionIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the current bank of specified region index. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">regionIndex</td><td>the 512KB region index we want to get. Accepted values: 1-7 as region 0 (0x000000-0x07FFFF) is fixed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the effective 512KB data bank index mapped on this region (0 to 63) </dd></dl>

</div>
</div>
<a class="anchor" id="ad2ef2c089ec2efc0d581e6705268359e"></a><!-- doxytag: member="mapper.h::SYS_getFarData" ref="ad2ef2c089ec2efc0d581e6705268359e" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* SYS_getFarData </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make the given binary data ressource accessible and return a pointer to it. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>far data we want to access.</td></tr>
  </table>
  </dd>
</dl>
<p>This method will use bank switching to make the specified data accessible and return a valid pointer to it.<br/>
 <b>WARNING:</b> this method use the 0x00300000-0x003FFFFF range (2 regions) to make the requested data accessible using bank switching mechanism.<br/>
 If data bank is already accessible it re-uses the region otherwise it will change bank of one of the region so be careful of that if you want to access data from different data bank at same time :p </p>

</div>
</div>
<a class="anchor" id="a48c54175e83a58e50f896518addb0773"></a><!-- doxytag: member="mapper.h::SYS_setBank" ref="a48c54175e83a58e50f896518addb0773" args="(u16 regionIndex, u16 bankIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SYS_setBank </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a8aa9149a22317014c683c48cebd8cfef">u16</a>&#160;</td>
          <td class="paramname"><em>regionIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a8aa9149a22317014c683c48cebd8cfef">u16</a>&#160;</td>
          <td class="paramname"><em>bankIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the current bank of specified region index. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">regionIndex</td><td>the 512KB region index we want to set. Accepted values: 1-7 as region 0 (0x000000-0x07FFFF) is fixed. </td></tr>
    <tr><td class="paramname">bankIndex</td><td>the effective 512KB data bank index mapped on this region. Accepted values: 0-63 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="mapper_8h.html">mapper.h</a>      </li>
      <li class="footer">Generated on Wed Dec 2 2020 22:53:19 for sgdk by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
