<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>sgdk: saveman.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">sgdk</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('saveman_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">saveman.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Save manager for flash memory chips supported by the flash module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="types_8h_source.html">types.h</a>&quot;</code><br/>
</div>
<p><a href="saveman_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br/>
&#160;&#160;<a class="el" href="saveman_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba8f58745625a80b05e34dfaf2405477d7">SM_STAT_PARAM_ERR</a> =  -3, 
<a class="el" href="saveman_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba9812c9de7d103a0fc16c04fdd6521349">SM_STAT_HW_ERR</a> =  -2, 
<a class="el" href="saveman_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba21188001758b83ffe2b2aef3acc1fc39">SM_STAT_ERR</a> =  -1, 
<a class="el" href="saveman_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba67bdb3762b1e6c3df99eefc7e8e578d1">SM_STAT_OK</a> =  0, 
<br/>
&#160;&#160;<a class="el" href="saveman_8h.html#a06fc87d81c62e9abb8790b6e5713c55bad9e4b0748c1aaaab37f4f076fd08c111">SM_STAT_WARN_NO_DATA</a> =  1
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Status code for some of the function calls /.  <a href="saveman_8h.html#a06fc87d81c62e9abb8790b6e5713c55b">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saveman_8h.html#aea5aa44166712ef212ea531afb132aaa">sm_init</a> (uint8_t num_slots, uint32_t max_length_restrict)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise save manager module. Must be called once before invoking any other function in the module.  <a href="#aea5aa44166712ef212ea531afb132aaa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab82cb9f2900320362ae3da11b5fae4bd"></a><!-- doxytag: member="saveman.h::sm_deinit" ref="ab82cb9f2900320362ae3da11b5fae4bd" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saveman_8h.html#ab82cb9f2900320362ae3da11b5fae4bd">sm_deinit</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deinitialises save manager module. Usually you do not have to use this function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saveman_8h.html#a0c9087501542b3e56d11423691517ad3">sm_load</a> (uint8_t slot, void *save_data, uint16_t len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Load previously saved data for the specified slot.  <a href="#a0c9087501542b3e56d11423691517ad3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saveman_8h.html#a403471888fcf12c2a05ffbd5e9f793e3">sm_save</a> (uint8_t slot, const void *save_data, uint16_t len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Save data to the specified slot.  <a href="#a403471888fcf12c2a05ffbd5e9f793e3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saveman_8h.html#aecbfbe454f6a346bff62c20bb16e9200">sm_delete</a> (uint8_t slot)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete data from specified slot.  <a href="#aecbfbe454f6a346bff62c20bb16e9200"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saveman_8h.html#a8f81af86413768eb71f02b10a0dbde24">sm_clear</a> (uint8_t num_slots)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes all save data from all save slots, and reinitializes the module to support the requested number of save slots.  <a href="#a8f81af86413768eb71f02b10a0dbde24"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Save manager for flash memory chips supported by the flash module. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Jesus Alonso (doragasu) </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>10/2022</dd></dl>
<p>This module allows saving data to non volatile flash chips. It supports as many save slots as required, and arbitrary data lengths can be written to each slot. This allows defining for example a 5 slot layout that uses slot 0 for the game configuration, slot 1 to keep high scores and slots 2 to 4 to save games. Each time data is written to a slot, it replaces whatever was written to the slot previously.</p>
<p>The module uses two sectors from the flash chip in order to implement flash wear leveling and safe save: the save file is not lost even if there is a power cut during save operation. Note that typical flash chips used in carts such as Krikkzz Flash Kit Cart use 64 KiB sectors at the end of the flash, so if you want to use this module, it will use the top 128 KiB of the ROM address space by default. Keep this in mind because if code/data falls there, it will be erased by this module routines, breaking your game! There is also a way to use 8 KiB sectors from these carts, in order to waste 16 KiB instead of 128 KiB, but it is a bit tricky, so unless you are very tight on ROM space, better use the default layout. Using the default 128 KiB layout has two additional benefits: wear is reduced and bigger save lengths are possible.</p>
<p>Note when you define the slot layout, you must make sure all of them fit in a single sector (plus a bit more room for internal headers). So e.g. if you use 64 KiB sectors and have 5 slots with 2 KiB each, that will fit without a problem, but if you use 8 KiB sectors, that config will not fit (5 x 2 KiB = 10 KiB, bigger than the 8 KiB available in the sector). Make sure your sector configuration is correct, because if it isn't, the module will work initially, but will fail when more slots are saved and they do not fit in one sector.</p>
<p>Typical usage of the module is as follows:</p>
<p>1. Call <a class="el" href="saveman_8h.html#aea5aa44166712ef212ea531afb132aaa" title="Initialise save manager module. Must be called once before invoking any other function in the module...">sm_init()</a> to initialize the module. Make sure it is always called with the same parameters. 2. Call <a class="el" href="saveman_8h.html#a0c9087501542b3e56d11423691517ad3" title="Load previously saved data for the specified slot.">sm_load()</a> to load data, <a class="el" href="saveman_8h.html#a403471888fcf12c2a05ffbd5e9f793e3" title="Save data to the specified slot.">sm_save()</a> to save data and <a class="el" href="saveman_8h.html#aecbfbe454f6a346bff62c20bb16e9200" title="Delete data from specified slot.">sm_delete()</a> to delete saved data. 3. In case you need to perform a factory reset, call <a class="el" href="saveman_8h.html#a8f81af86413768eb71f02b10a0dbde24" title="Deletes all save data from all save slots, and reinitializes the module to support the requested numb...">sm_clear()</a>.</p>
<p>The module has been carefully written, but some of its logic is a bit complex, so make sure you test it thoroughly just in case there is a bug lurking inside!</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Excepting <a class="el" href="saveman_8h.html#a0c9087501542b3e56d11423691517ad3" title="Load previously saved data for the specified slot.">sm_load()</a>, all module functions stop Z80 and disable interrupts until they return. Thus you shall make sure no music or sound is playing when you call them. </dd></dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>Save/load buffers must be word aligned or you will get a SM_STAT_INVALID_PARAM_ERR error. Variables using types with a length equal or bigger than 2 bytes will be aligned (same as structs with at least one variable obeying this rule), but if variable has a type with length 1 (such as a char array), to make sure it is aligned, you can use the attribute: __attribute__((aligned(2))) in the declaration. </dd>
<dd>
If any save write operation returns a SM_STAT_HW_ERR, something weird has occurred. Your best chance if this happens is to either restart the console or at least deinit and init this module to let the init routine try correcting the mess and avoid further data loss. </dd></dl>
</div><hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55b"></a><!-- doxytag: member="saveman.h::@0" ref="a06fc87d81c62e9abb8790b6e5713c55b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Status code for some of the function calls /. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba8f58745625a80b05e34dfaf2405477d7"></a><!-- doxytag: member="SM_STAT_PARAM_ERR" ref="a06fc87d81c62e9abb8790b6e5713c55ba8f58745625a80b05e34dfaf2405477d7" args="" -->SM_STAT_PARAM_ERR</em>&nbsp;</td><td>
<p>Invalid parameter in function call. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba9812c9de7d103a0fc16c04fdd6521349"></a><!-- doxytag: member="SM_STAT_HW_ERR" ref="a06fc87d81c62e9abb8790b6e5713c55ba9812c9de7d103a0fc16c04fdd6521349" args="" -->SM_STAT_HW_ERR</em>&nbsp;</td><td>
<p>Flash chip hardware related error. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba21188001758b83ffe2b2aef3acc1fc39"></a><!-- doxytag: member="SM_STAT_ERR" ref="a06fc87d81c62e9abb8790b6e5713c55ba21188001758b83ffe2b2aef3acc1fc39" args="" -->SM_STAT_ERR</em>&nbsp;</td><td>
<p>Generic error. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55ba67bdb3762b1e6c3df99eefc7e8e578d1"></a><!-- doxytag: member="SM_STAT_OK" ref="a06fc87d81c62e9abb8790b6e5713c55ba67bdb3762b1e6c3df99eefc7e8e578d1" args="" -->SM_STAT_OK</em>&nbsp;</td><td>
<p>Success. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a06fc87d81c62e9abb8790b6e5713c55bad9e4b0748c1aaaab37f4f076fd08c111"></a><!-- doxytag: member="SM_STAT_WARN_NO_DATA" ref="a06fc87d81c62e9abb8790b6e5713c55bad9e4b0748c1aaaab37f4f076fd08c111" args="" -->SM_STAT_WARN_NO_DATA</em>&nbsp;</td><td>
<p>Success, chip has no data saved. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a8f81af86413768eb71f02b10a0dbde24"></a><!-- doxytag: member="saveman.h::sm_clear" ref="a8f81af86413768eb71f02b10a0dbde24" args="(uint8_t num_slots)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t sm_clear </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>num_slots</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes all save data from all save slots, and reinitializes the module to support the requested number of save slots. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">num_slots</td><td>Number of slots to support after data clear.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Status code:<ul>
<li>SM_STAT_OK: Clear operation successful.</li>
<li>SM_STAT_HW_ERR: Flash chip failed to erase.</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function halts Z80 and disables interrupts until it done. </dd></dl>

</div>
</div>
<a class="anchor" id="aecbfbe454f6a346bff62c20bb16e9200"></a><!-- doxytag: member="saveman.h::sm_delete" ref="aecbfbe454f6a346bff62c20bb16e9200" args="(uint8_t slot)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t sm_delete </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delete data from specified slot. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slot</td><td>Slot to delete.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Status code:<ul>
<li>SM_STAT_OK: Delete operation successful.</li>
<li>SM_STAT_PARAM_ERR: Invalid parameter in invocation.</li>
<li>SM_STAT_HW_ERR: Delete operation failed due to flash error.</li>
<li>SM_STAT_ERR: Other unrecoverable error.</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function halts Z80 and disables interrupts until it done. </dd></dl>

</div>
</div>
<a class="anchor" id="aea5aa44166712ef212ea531afb132aaa"></a><!-- doxytag: member="saveman.h::sm_init" ref="aea5aa44166712ef212ea531afb132aaa" args="(uint8_t num_slots, uint32_t max_length_restrict)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t sm_init </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>num_slots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>max_length_restrict</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise save manager module. Must be called once before invoking any other function in the module. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">num_slots</td><td>Number of save slots to support. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_length_restrict</td><td>Maximum flash length the module can use. The module uses the last two sectors available. If you set this to 0, the module defaults to use the last two sectors in the 4 MiB range. But if you want to restrict it e.g. to 2 MiB to use a smaller chip, you can set it e.g. to 0x200000. This can also be used to alloc the smaller sectors in the flash chip, by pointing to the end of two of these sectors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Status code:<ul>
<li>SM_STAT_OK if initialisation was successful and flash has data to load.</li>
<li>SM_STAT_WARN_NO_DATA if initialisation was successful but there is no save data to load.</li>
<li>SM_STAT_PARAM_ERR if function was called with invalid parameters.</li>
<li>SM_STAT_HW_ERR if the flash chip failed to perform any operation.</li>
<li>SM_ERR if other unrecoverable error was found.</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function internally calls <a class="el" href="flash_8h.html#a657aa34ab6dc1b40662457a4388dca53" title="Initialise flash chip. Call this function only once, before any other function in the module...">flash_init()</a>, you must not call it by yourself. </dd>
<dd>
This function halts Z80 and disables interrupts until it done. </dd></dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>This module uses the last two sectors available in the specified range. Typically this is from 0x3E0000 to 0x3FFFFF for the default value of max_length_restrict set to 0. You must make sure there is no code in that area, or it will be erased by this module! </dd></dl>

</div>
</div>
<a class="anchor" id="a0c9087501542b3e56d11423691517ad3"></a><!-- doxytag: member="saveman.h::sm_load" ref="a0c9087501542b3e56d11423691517ad3" args="(uint8_t slot, void *save_data, uint16_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t sm_load </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>save_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Load previously saved data for the specified slot. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slot</td><td>Slot from which we want to load the data. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">save_data</td><td>Buffer in which loaded data will be copied. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the data to load.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A positive number with the loaded data length, or a negative error status code:<ul>
<li>SM_STAT_PARAM_ERR: Invalid parameter in invocation.</li>
<li>SM_STAT_ERR: The requested slot has no data available.</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Readed bytes can be less than len if there is an error (e.g. 0 if the slot has no data, or less than len if less data than requested was saved). </dd></dl>

</div>
</div>
<a class="anchor" id="a403471888fcf12c2a05ffbd5e9f793e3"></a><!-- doxytag: member="saveman.h::sm_save" ref="a403471888fcf12c2a05ffbd5e9f793e3" args="(uint8_t slot, const void *save_data, uint16_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t sm_save </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>save_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Save data to the specified slot. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slot</td><td>Slot to which we want to save the data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">save_data</td><td>Data buffer to save in the slot. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the data to save.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Status code:<ul>
<li>SM_STAT_OK: Save operation successful.</li>
<li>SM_STAT_PARAM_ERR: Invalid parameter in invocation.</li>
<li>SM_STAT_HW_ERR: Save operation failed due to flash error.</li>
<li>SM_STAT_ERR: Other unrecoverable error.</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Readed bytes can be less than len if there is an error. </dd>
<dd>
This function halts Z80 and disables interrupts until it done. </dd></dl>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="saveman_8h.html">saveman.h</a>      </li>
      <li class="footer">Generated on Wed Jan 31 2024 23:59:38 for sgdk by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
